"use strict";(self["webpackChunkruifox_oauth2"]=self["webpackChunkruifox_oauth2"]||[]).push([[541],{541:function(e,a,l){l.r(a),l.d(a,{default:function(){return B}});l(560);var o=l(8473),t=l(4887),r=l(4775),i=l(676),u=l(4188),d=l(4731),n=l(5374);const s=e=>((0,o.dD)("data-v-15d511d8"),e=e(),(0,o.Cn)(),e),c={class:"login-home","element-loading-text":"系统加载中...",fullscreen:!0},p={class:"login-box"},v=s((()=>(0,o._)("div",{class:"login-header"},[(0,o._)("img",{src:r,alt:""})],-1))),g={class:"login-body"},m={key:0,class:"login-form"},A={class:"form-body"},w=s((()=>(0,o._)("div",{class:"tab-label"},[(0,o._)("i",{class:"iconfont"},""),(0,o.Uk)("账户密码登录 ")],-1))),f=["src"],h=s((()=>(0,o._)("div",{class:"tab-label"},[(0,o._)("i",{class:"iconfont"},""),(0,o.Uk)("手机验证码登录 ")],-1))),y={class:"form-btn"},_={key:0,class:"form-footer"},k={key:1,class:"login-qrcode"},C=s((()=>(0,o._)("div",{id:"qr_code"},null,-1))),W=[C],U=s((()=>(0,o._)("div",{class:"change-way-btn"},[(0,o._)("i",{class:"iconfont"},"")],-1))),b=s((()=>(0,o._)("i",{class:"iconfont"},"",-1))),q={key:3,class:"change-way-btn"},M=s((()=>(0,o._)("div",{class:"login-footer"},[(0,o._)("div",{class:"copyright"},"锐狐科技有限公司"),(0,o._)("div",{class:"copyright"},"© 2006-2023 ruifox.com 版权所有 蜀ICP备07001898号-1 川公网安备：51010402000199号")],-1)));var V={__name:"LoginHome",setup(e){const a=(0,d.tv)(),l=(0,d.yj)(),r=(0,u.iH)("user"),s=(0,u.iH)(!0),C=(e,a,l)=>{if(!a)return l(new Error("请输入验证码"));(0,n.Sw)({code:a}).then((e=>e&&200===e.code?l():l(new Error("验证码错误"))))},V=(0,u.iH)(null),D=(0,u.qj)({name:[{required:!0,message:"请输入用户名",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],captcha:[{validator:C,trigger:"blur"}]}),F=(0,u.iH)({name:"",pwd:"",captcha:""}),B=(0,u.iH)(null),E=(e,a,l)=>a?/^1[3456789]\d{9}$/.test(a)?void l():l(new Error("请输入正确的手机号")):l(new Error("请输入手机号")),I=(0,u.qj)({phone:[{validator:E,trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]}),x=(0,u.iH)({phone:"",code:""}),H=(0,u.iH)(0),O=(0,u.iH)(null),P=()=>{H.value=60,O.value=setInterval((()=>{H.value>0?H.value--:(clearInterval(O.value),O.value=null)}),1e3)},R=(0,u.iH)(""),Y=async()=>{let e=await(0,n.O$)();e&&200===e.code&&(R.value=e.data.captcha)},N=()=>{"user"===r.value?V.value.validate((async e=>{if(e){let e=await(0,n.XR)(F.value);e&&200===e.code&&(window.location.href=localStorage.getItem("authPage"))}})):B.value.validate((e=>{e&&console.log(x.value,"phone")}))},j=()=>{},S=(0,u.iH)(!1),z=(0,u.iH)("form"),T=async()=>{z.value="qrcode",S.value=!0;const e=await(0,n.t0)();if(200===e.code){let a={id:"qr_code",appid:e.data.appId,agentid:e.data.agentId,redirect_uri:e.data.redirectUri,state:e.data.state,scope:e.data.scope};new WwLogin(a),S.value=!1}},Q=()=>{a.push("/login/register")},L=()=>{/^1[3456789]\d{9}$/.test(x.value.phone)?0===H.value&&P():i.z8.error("请输入正确的手机号")};return(0,o.wF)((async()=>{let e=l.query.authorizationUri+"?client_id="+l.query.client_id+"&response_type="+l.query.response_type+"&redirect_uri="+l.query.redirect_uri;localStorage.setItem("authPage",e);let a=window.navigator.userAgent.toLowerCase();if(a.match(/wxwork/i)){let e=await(0,n.uP)();if(200===e.code)return void(window.location.href=e.data)}let o=await(0,n.bg)();o.data&&(l.query.scope&&(e+="&scope="+l.query.scope,localStorage.setItem("authPage",e)),window.location.href=e),s.value=!1,Y()})),(0,o.Jd)((()=>{clearInterval(O.value)})),(e,a)=>{const l=(0,o.up)("el-input"),i=(0,o.up)("el-form-item"),u=(0,o.up)("el-form"),d=(0,o.up)("el-tab-pane"),n=(0,o.up)("el-button"),C=(0,o.up)("el-tabs"),E=(0,o.up)("el-popover"),O=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("div",p,[v,(0,o._)("div",g,["form"===z.value?((0,o.wg)(),(0,o.iD)("div",m,[(0,o._)("div",A,[(0,o.Wm)(C,{modelValue:r.value,"onUpdate:modelValue":a[5]||(a[5]=e=>r.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{name:"user"},{label:(0,o.w5)((()=>[w])),default:(0,o.w5)((()=>[(0,o.Wm)(u,{model:F.value,rules:D,ref_key:"userFormRef",ref:V},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{prop:"name"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:F.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value.name=e),type:"text",size:"large",placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(i,{prop:"pwd"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:F.value.pwd,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value.pwd=e),type:"password",size:"large",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(i,{prop:"captcha",class:"captcha"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:F.value.captcha,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value.captcha=e),type:"text",size:"large",placeholder:"请输入验证码"},null,8,["modelValue"]),(0,o._)("img",{src:R.value,alt:"",class:"captcha-item",onClick:Y},null,8,f)])),_:1})])),_:1},8,["model","rules"])])),_:1}),(0,o.Wm)(d,{name:"phone"},{label:(0,o.w5)((()=>[h])),default:(0,o.w5)((()=>[(0,o.Wm)(u,{model:x.value,rules:I,ref_key:"phoneFormRef",ref:B},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{prop:"phone"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:x.value.phone,"onUpdate:modelValue":a[3]||(a[3]=e=>x.value.phone=e),type:"text",size:"large",placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(i,{prop:"code",class:"form-code"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:x.value.code,"onUpdate:modelValue":a[4]||(a[4]=e=>x.value.code=e),type:"text",size:"large",placeholder:"请输入验证码"},null,8,["modelValue"]),(0,o.Wm)(n,{size:"large",onClick:L,disabled:H.value>0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(H.value>0?H.value+"秒后重新获取":"获取验证码"),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1},8,["modelValue"])]),(0,o._)("div",y,[(0,o.Wm)(n,{type:"primary",size:"large",onClick:N},{default:(0,o.w5)((()=>[(0,o.Uk)("登录")])),_:1})]),"phone"!==r.value?((0,o.wg)(),(0,o.iD)("div",_,[(0,o.Wm)(n,{link:"",type:"primary",onClick:j},{default:(0,o.w5)((()=>[(0,o.Uk)("忘记密码")])),_:1}),(0,o.Wm)(n,{link:"",type:"primary",onClick:Q},{default:(0,o.w5)((()=>[(0,o.Uk)("注册账户")])),_:1})])):(0,o.kq)("",!0)])):(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",k,W)),[[O,S.value]]),"form"===z.value?((0,o.wg)(),(0,o.j4)(E,{key:2,placement:"right",width:150,trigger:"hover","popper-class":"my-popper"},{reference:(0,o.w5)((()=>[U])),default:(0,o.w5)((()=>[(0,o._)("div",{class:"option-list"},[(0,o._)("div",{class:"option-item",style:{"padding-left":"20px",cursor:"pointer",color:"#4D99F2"},onClick:T},[b,(0,o.Uk)("企业微信")])])])),_:1})):(0,o.kq)("",!0),"qrcode"===z.value?((0,o.wg)(),(0,o.iD)("div",q,[(0,o._)("i",{class:"iconfont",onClick:a[6]||(a[6]=e=>z.value="form")},"")])):(0,o.kq)("",!0)])])])),[[O,s.value]]),M],64)}}},D=l(5312);const F=(0,D.Z)(V,[["__scopeId","data-v-15d511d8"]]);var B=F},4775:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABI1BMVEUAd8WizerA3fG93PC/3fC72/CcyuhJntYHe8fk8fn///+gzOkRgMnP5fSPw+bm8vn0+fw+mNNrsN2FvuOCvON+uuKOw+Xf7viBvOJMoNbz+fwDecYZhMvc7Pep0esFesYQgMkUgspgqtv9/v8li814t+Cn0OvC3vHB3vHI4vL5/P53tuBCmtTa6/fi8Pgtj88fiMx2tuDq9Pq52u/X6vaYyOh5uOF7ueFws945ldLO5fTy+Pxap9kJfMfS5/X2+v1eqdoiic3Q5vT+/v/d7ffl8fmWx+dIndWt0+wXg8pcqNqv1O201+7Y6vbU6PVUpNifzOng7vjL4/MWg8rD3/Fvst662u/8/f4dhsyZyei12O6y1u232e+DveMOfshEm9QYhMpnSgvZAAAAAWJLR0QKaND0VgAAAAd0SU1FB+cLHAwYM55bWIcAAADySURBVDjLY2AYToCRiRkGWFjZ2DkwFHByoQBuHnQFvKgKuPjQFfCjKRAQRFMgJCwCBaJi4iAVEngcLCkFcoU0bgUyskAFcpgeYZDnAQEFRSVloAI2DBNUVNXUNZiYmFg0tUBu0EaX19FF8YWePpq8gTiqNw3RDTCEyYDs5zISxXCgMUyBiamZuYUlpg+sYAqsmW1ssfndDsl+e2MHRwwFTlxczi6acDWubu7SGAq4PDy9vKVgSmRlMBX4MDBwqIj4gsOJyw9NgRVEARDY+gcEAjlBwagKXIFiITCOfmhYOH8EqoLIqOiYWAQ3Ll44gWHoAAC7Dx1xWpNkzAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0xMS0yOFQxMToyNDo1MSswMTowMGd7PNkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMTEtMjhUMTE6MjQ6NTErMDE6MDAWJoRlAAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=541.bd213c7d.js.map