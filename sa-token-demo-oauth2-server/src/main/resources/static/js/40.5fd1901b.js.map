{"version":3,"file":"js/40.5fd1901b.js","mappings":"wlCA+CA,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAQC,EAAAA,EAAAA,MAERC,GAAYC,EAAAA,EAAAA,KAAS,IAClBH,EAAMI,QAEfC,QAAQC,IAAIJ,EAAUK,MAAO,KAC7B,MAAMC,EAAeA,OACfC,EAAcC,UAClB,IAAIC,QAAYC,EAAAA,EAAAA,IAAUV,EAAUK,OACpC,GAAII,GAAoB,MAAbA,EAAIE,KACb,IASEC,OAAOC,SAASC,KAAO,qDAAuDd,EAAUK,MAAMU,UAAY,kBAAoBf,EAAUK,MAAMW,cAChJ,iBAAmBhB,EAAUK,MAAMY,aAAe,UAAYjB,EAAUK,MAAMa,KAC9E,CAAC,MAED,CAAC,QACCf,QAAQC,IAAIQ,OAAOC,SAASC,KAAM,IACpC,CACF,EASIK,GAAWC,EAAAA,EAAAA,IAAI,CAAC,GAChBC,EAAeb,UACnB,IAAIC,QAAYa,EAAAA,EAAAA,IAAY,CAAEC,SAAUvB,EAAUK,MAAMU,YACpDN,GAAoB,MAAbA,EAAIE,OACbQ,EAASd,MAAQI,EAAIe,KACvB,E,OAEFC,EAAAA,EAAAA,KAAU,KACRb,OAAOc,QAAU,SAASC,EAASC,EAAKC,EAAMC,EAAQC,GAEpD5B,QAAQ4B,MAAM,QAASJ,EAASI,EAAO,OACzC,CAAC,KAEHC,EAAAA,EAAAA,KAAcxB,UACZ,IAAIC,QAAYwB,EAAAA,EAAAA,MACXxB,EAAIe,MACP5B,EAAOsC,KAAK,CACVC,KAAM,SACNjC,MAAOJ,EAAMI,cAGXmB,GAAc,I,k5BClGtB,MAAMe,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://ruifox-oauth2/./src/views/login/Authorize.vue","webpack://ruifox-oauth2/./src/views/login/Authorize.vue?62f1"],"sourcesContent":["<template>\r\n  <div class=\"authorize\">\r\n    <div class=\"authorize-header\">\r\n      <img :src=\"authInfo.clientIcon\" alt=\"\">\r\n      <div class=\"title\">{{authInfo.clientName}}</div>\r\n    </div>\r\n    <el-card class=\"authorize-card\">\r\n      <div class=\"card-top\">\r\n        <div class=\"authorize-detail\">\r\n          <div class=\"detail-left\"></div>\r\n          <div class=\"detail-right\">\r\n            <div class=\"detail-right-title\">授权单点登录站</div>\r\n            <div class=\"detail-right-desc\">想要获取您的账户{{authInfo.account}}的权限</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"authorize-detail\">\r\n          <div class=\"detail-left\">\r\n            <img v-if=\"authInfo.avatar\" :src=\"authInfo.avatar\" alt=\"\">\r\n            <i v-else class=\"iconfont\">&#xe62f;</i>\r\n          </div>\r\n          <div class=\"detail-right\">\r\n            <div class=\"detail-right-title\">授权后，将获得以下用户数据</div>\r\n            <div class=\"detail-right-desc\">获得您的昵称、头像、和其他用户个人信息</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"card-bottom\">\r\n        <div class=\"authrize-btns\">\r\n          <el-button type=\"danger\" size=\"large\" @click=\"handleReject\">拒绝</el-button>\r\n          <el-button type=\"primary\" size=\"large\" @click=\"handleAgree\">同意</el-button>\r\n        </div>\r\n        <div class=\"authrize-link\">\r\n          授权后表明你已同意<span class=\"protocol\"> 锐狐互联网站点服务协议 </span>\r\n          <p class=\"link\">{{authInfo.redirect_uri}}</p>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n    <div id=\"form-container\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n/* eslint-disable */\r\nimport { computed, ref, onBeforeMount, onMounted } from 'vue'\r\nimport { doConfirm, isLogin, getAuthInfo, authorize } from '@/api/login'\r\nimport { useRouter, useRoute } from 'vue-router'\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n//授权地址信息\r\nconst authRoute = computed(() => {\r\n  return route.query\r\n})\r\nconsole.log(authRoute.value, 777)\r\nconst handleReject = () => { }\r\nconst handleAgree = async () => {\r\n  let res = await doConfirm(authRoute.value)\r\n  if (res && res.code === 200) {\r\n    try{\r\n      // const form = document.createElement('form')\r\n      // form.action = \"http://10.10.0.29:8001/oauth2/authorize?client_id=\" + authRoute.value.client_id + '&response_type=' + authRoute.value.response_type + '&redirect_uri=' + authRoute.value.redirect_uri + '&scope=' + authRoute.value.scope\r\n      // console.log(form.action,1616)\r\n      // document.getElementById(\"form-container\").appendChild(form)\r\n      // form.submit()\r\n      // document.getElementById(\"form-container\").removeChild(form)\r\n      // await authorize(authRoute.value)\r\n      // window.location.href = 'http://127.0.0.1:8080/?code=J7cfTV1p9rtniPVXZGuWScAyZlYPpLlQ7Fi4VYDALlayvwjbX5BvzF43tZJd'\r\n      window.location.href = 'http://10.10.0.29:8001/oauth2/authorize?client_id=' + authRoute.value.client_id + '&response_type=' + authRoute.value.response_type\r\n  + '&redirect_uri=' + authRoute.value.redirect_uri + '&scope=' + authRoute.value.scope\r\n    }catch{\r\n\r\n    }finally{\r\n      console.log(window.location.href, 888)\r\n    }\r\n  }\r\n}\r\n// var link = document.createElement('a');\r\n// link.href = 'http://127.0.0.1:8081/login/authorize?client_id=' + authRoute.value.client_id + '&response_type=' + authRoute.value.response_type\r\n//   + '&redirect_uri=' + authRoute.value.redirect_uri + '&scope=' + authRoute.value.scope;\r\n// link.target = '_blank'\r\n// console.log(link.href, 888)\r\n// link.click()\r\n//授权用户信息\r\nconst authInfo = ref({})\r\nconst _getAuthInfo = async () => {\r\n  let res = await getAuthInfo({ clientId: authRoute.value.client_id })\r\n  if (res && res.code === 200) {\r\n    authInfo.value = res.data\r\n  }\r\n}\r\nonMounted(() => {\r\n  window.onerror = function(message, url, line, column, error) {\r\n    // 处理错误\r\n    console.error('发生错误：', message, error, 565656);\r\n  };\r\n})\r\nonBeforeMount(async () => {\r\n  let res = await isLogin()\r\n  if (!res.data) {\r\n    router.push({\r\n      path: '/login',\r\n      query: route.query\r\n    })\r\n  }\r\n  await _getAuthInfo()\r\n})\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.authorize{\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    padding-top: 100px;\r\n    .authorize-header{\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        margin-bottom: 40px;\r\n        img{\r\n            margin-bottom: 20px;\r\n            width: 6rem;\r\n            border-radius: 50%;\r\n        }\r\n        .title{\r\n            font-size: 24px;\r\n        }\r\n    }\r\n    .authorize-card{\r\n        width: 500px;\r\n        .card-top{\r\n            border-bottom: 1px solid #ebeef5;\r\n            .authorize-detail{\r\n                display: flex;\r\n                align-items: center;\r\n                margin-bottom: 40px;\r\n                .detail-left{\r\n                    margin-right: 15px;\r\n                    width: 40px;\r\n                    height: 40px;\r\n                    overflow: hidden;\r\n                    i{\r\n                        font-size: 40px;\r\n                        color: #aaa;\r\n                    }\r\n                    img{\r\n                      width: 100%;\r\n                    }\r\n                }\r\n                .detail-right{\r\n                    .detail-right-title{\r\n                        margin-bottom: 5px;\r\n                        font-size: 16px;\r\n                        color: #24292e;\r\n                    }\r\n                    .detail-right-desc{\r\n                        font-size: 14px;\r\n                        color: #586069;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        .card-bottom{\r\n            padding-top: 30px;\r\n            .authrize-btns{\r\n                display: flex;\r\n                flex-wrap: nowrap;\r\n                margin-bottom: 30px;\r\n                .el-button{\r\n                    width: 100%;\r\n                }\r\n            }\r\n            .authrize-link{\r\n                text-align: center;\r\n                color: #586069;\r\n                .link{\r\n                    margin-top: 5px;\r\n                    color: #24292e;\r\n                }\r\n                .protocol{\r\n                    color: #E9686B;\r\n                    text-decoration: underline;\r\n                    cursor: pointer;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n::v-deep .el-card__body{\r\n    padding: 40px;\r\n}\r\n</style>","import script from \"./Authorize.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Authorize.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Authorize.vue?vue&type=style&index=0&id=ef9ea10e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ef9ea10e\"]])\n\nexport default __exports__"],"names":["router","useRouter","route","useRoute","authRoute","computed","query","console","log","value","handleReject","handleAgree","async","res","doConfirm","code","window","location","href","client_id","response_type","redirect_uri","scope","authInfo","ref","_getAuthInfo","getAuthInfo","clientId","data","onMounted","onerror","message","url","line","column","error","onBeforeMount","isLogin","push","path","__exports__"],"sourceRoot":""}